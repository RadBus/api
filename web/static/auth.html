<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8' />
  </head>
  <body>
    <button id="authorize-button" style="visibility: hidden">Authorize</button>

    <div id="content"></div>

    <script type="text/javascript">
      function handleClientLoad() {
        gapi.client.setApiKey(googleClientSecret);
        window.setTimeout(checkAuth,1);
      }

      function checkAuth() {
        gapi.auth.authorize({
          client_id: googleClientId,
          scope: googleAuthScopes,
          immediate: true
        }, handleAuthResult);
      }

      function handleAuthResult(authResult) {
        var authorizeButton = document.getElementById('authorize-button');
        if (authResult && !authResult.error) {
          authorizeButton.style.visibility = 'hidden';

          var message =
            "token_type: " + authResult.token_type + "\n" +
            "access_token: " + authResult.access_token;

          window.alert(message);

        } else {
          authorizeButton.style.visibility = '';
          authorizeButton.onclick = handleAuthClick;
        }
      }

      function handleAuthClick(event) {
        gapi.auth.authorize({
          client_id: googleClientId,
          scope: googleAuthScopes,
          immediate: false
        }, handleAuthResult);
        return false;
      }
    </script>
    <script type="text/javascript" src="/js/config.js"></script>
    <script type="text/javascript" src="https://apis.google.com/js/client.js?onload=handleClientLoad"></script>
  </body>
</html>
